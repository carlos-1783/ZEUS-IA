import{p as F,r as g,c as C,x as L,q as j,y as z,o as a,b as o,e,t as u,n as v,k as _,g as E,C as R,z as H,A as B,B as U,f as I,w as O,F as V,D as N,E as G,G as J,h as T,H as W,I as K,J as Q}from"./vendor-517526e0.js";import{u as q,_ as P}from"./index-40046b22.js";import{u as X}from"./WebSocketService-4f2cbb64.js";const Y=["title"],Z={class:"status-text"},ee=F({__name:"SystemStatusBadge",setup(n){const i=q(),{status:l,error:p,connect:m,disconnect:y,cleanup:b}=X(),x=g(null),w=C(()=>{switch(l.value){case"connected":return"Connected";case"connecting":return"Connecting...";case"reconnecting":return"Reconnecting...";case"error":return"Connection Error";default:return"Disconnected"}}),S=C(()=>({"status-connected":l.value==="connected","status-connecting":l.value==="connecting","status-reconnecting":l.value==="reconnecting","status-error":l.value==="error","status-disconnected":l.value==="disconnected"})),k=C(()=>p.value?`Error: ${p.value.message}`:x.value?`Error: ${x.value.message}`:w.value);L(p,r=>{r&&(x.value=r)});const $=()=>{try{if(!i)return;i.isAuthenticated&&i.token&&m(i.token).catch(r=>{const d=r instanceof Error?r:new Error(String(r));x.value=d,d.message.includes("Network error")||d.message.includes("Tiempo de conexión agotado")})}catch(r){const d=r instanceof Error?r:new Error(String(r));x.value=d}};return L(()=>i.token,(r,d)=>{try{if(!r&&d){y();return}r&&i.isAuthenticated&&m(r).catch(f=>{const h=f instanceof Error?f:new Error(String(f));x.value=h})}catch(f){const h=f instanceof Error?f:new Error(String(f));x.value=h}},{immediate:!0}),j(()=>{$()}),z(()=>{b()}),(r,d)=>(a(),o("div",{class:v(["system-status-badge",S.value]),title:k.value},[d[0]||(d[0]=e("span",{class:"status-dot"},null,-1)),e("span",Z,u(w.value),1)],10,Y))}});const te=P(ee,[["__scopeId","data-v-09c05868"]]);const se={class:"bg-white overflow-hidden shadow rounded-lg"},ne={class:"p-5"},re={class:"flex items-center"},ae={key:1,class:"h-6 w-6"},oe={class:"ml-5 w-0 flex-1"},ie={class:"text-sm font-medium text-gray-500 truncate"},le={class:"text-lg font-medium text-gray-900"},de={key:0,class:"mt-4 flex items-center"},ce={key:1,class:"mt-4"},ue={__name:"DashboardMetric",props:{title:{type:String,required:!0},value:{type:[String,Number],required:!0},icon:{type:String,required:!0},trend:{type:String,validator:n=>["up","down",null,void 0].includes(n),default:null},trendValue:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(n){return(i,l)=>(a(),o("div",se,[e("div",ne,[e("div",re,[e("div",{class:v(["flex-shrink-0 rounded-md p-3",{"bg-indigo-100":!n.loading,"bg-gray-200":n.loading,"animate-pulse":n.loading}])},[n.loading?(a(),o("div",ae)):(a(),o("i",{key:0,class:v(["fas",`fa-${n.icon}`,"text-indigo-600 text-lg"])},null,2))],2),e("div",oe,[e("dl",null,[e("dt",ie,u(n.loading?"Cargando...":n.title),1),e("dd",null,[e("div",le,u(n.loading?"...":n.value),1)])])])]),!n.loading&&n.trend?(a(),o("div",de,[e("span",{class:v(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n.trend==="up"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("i",{class:v(["mr-1",n.trend==="up"?"fa-arrow-up":"fa-arrow-down"])},null,2),_(" "+u(n.trendValue),1)],2),l[0]||(l[0]=e("span",{class:"ml-2 text-sm text-gray-500"}," vs. período anterior ",-1))])):n.loading?(a(),o("div",ce,l[1]||(l[1]=[e("div",{class:"h-4 bg-gray-200 rounded w-3/4"},null,-1)]))):E("",!0)])]))}},ge=P(ue,[["__scopeId","data-v-b4acc032"]]);const me={class:"dashboard"},xe={key:0,class:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50"},fe={key:1,class:"fixed inset-0 bg-white flex items-center justify-center z-50"},pe={class:"text-center p-6 max-w-md mx-auto"},ve={class:"mt-2 text-sm text-gray-500"},he={class:"mt-5"},ye={class:"bg-white shadow"},_e={class:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8 flex justify-between items-center"},be={class:"flex items-center space-x-4"},we={class:"relative"},ke={class:"hidden md:inline text-sm font-medium text-gray-700"},Ce={key:0,class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50",role:"menu",tabindex:"-1"},Ee={class:"py-1",role:"none"},Se={class:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8"},$e={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8"},De={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},Ve={class:"lg:col-span-2 bg-white rounded-lg shadow p-6"},Ne={class:"flex justify-between items-center mb-4"},Le={class:"flex space-x-2"},Pe=["onClick"],Me={class:"h-64"},Ae={class:"bg-white shadow overflow-hidden sm:rounded-lg"},Be={class:"overflow-x-auto"},Ie={class:"min-w-full divide-y divide-gray-200"},je={class:"bg-white divide-y divide-gray-200"},ze={class:"px-6 py-4 whitespace-nowrap"},qe={class:"flex items-center"},Fe={class:"flex-shrink-0 h-10 w-10"},Re={class:"ml-4"},He={class:"text-sm font-medium text-gray-900"},Ue={class:"text-sm text-gray-500"},Oe={class:"px-6 py-4 whitespace-nowrap"},Ge={class:"text-sm text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap"},Te={class:"text-sm text-gray-500"},We={class:"px-6 py-4 whitespace-nowrap"},Ke={key:0},Qe={__name:"Dashboard",setup(n){R.register(...H);const i=q(),l=J(),p=g("día"),m=g(!1),y=g(!0),b=g(null),x=g(null);g(null);const w=g(null),S=g([{title:"Ventas Hoy",value:"1,245",icon:"shopping-cart",trend:"up",trendValue:"12%",loading:!1},{title:"Ingresos",value:"$12,548",icon:"dollar-sign",trend:"down",trendValue:"3%"},{title:"Clientes Nuevos",value:"24",icon:"users",trend:"up",trendValue:"8%"},{title:"Órdenes",value:"156",icon:"box",trend:"up",trendValue:"5%"}]),k=g([{id:1,title:"Nueva orden creada",description:"Orden #1001 por $125.75",type:"order",user:"Juan Pérez",timestamp:new Date,status:"completed"},{id:2,title:"Error de pago",description:"Error al procesar el pago #1002",type:"error",user:"María García",timestamp:B(new Date,1),status:"error"},{id:3,title:"Nuevo cliente registrado",description:"Carlos López se ha registrado",type:"user",user:"Sistema",timestamp:B(new Date,2),status:"completed"}]),$={order:"fas fa-shopping-cart",error:"fas fa-exclamation-circle",user:"fas fa-user-plus",system:"fas fa-cog"},r=C(()=>i.userFullName||"Usuario"),d=c=>{if(!c)return"";try{const t=typeof c=="string"?new Date(c):c;return K(t,"dd/MM/yyyy HH:mm",{locale:Q})}catch{return"Fecha inválida"}},f=async()=>{try{await i.logout(),l.push("/login")}catch{}},h=c=>{if(!m.value)return;const t=c.target,D=t.closest(".origin-top-right"),s=t.closest("button");!D&&!s&&(m.value=!1)},M=()=>{};return L(p,c=>{}),j(()=>{(()=>{y.value=!1,Promise.resolve().then(async()=>{try{if(!i.isAuthenticated){l.push("/auth/login");return}i.user&&(x.value=i.user),"requestIdleCallback"in window?requestIdleCallback(()=>{try{M()}catch{}},{timeout:2e3}):Promise.resolve().then(()=>{try{M()}catch{}})}catch{}})})(),document.addEventListener("click",h,{passive:!0})}),z(()=>{document.removeEventListener("click",h)}),(c,t)=>{const D=T("router-link");return a(),o("div",me,[y.value?(a(),o("div",xe,t[4]||(t[4]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e("p",{class:"mt-4 text-gray-700"},"Cargando datos del dashboard...")],-1)]))):b.value?(a(),o("div",fe,[e("div",pe,[t[7]||(t[7]=e("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[e("i",{class:"fas fa-exclamation-triangle text-red-600 text-xl"})],-1)),t[8]||(t[8]=e("h3",{class:"mt-3 text-lg font-medium text-gray-900"},"Error al cargar el dashboard",-1)),e("p",ve,u(b.value),1),e("div",he,[e("button",{onClick:t[0]||(t[0]=(...s)=>c.retryLoading&&c.retryLoading(...s)),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},t[5]||(t[5]=[e("i",{class:"fas fa-sync-alt mr-2"},null,-1),_(" Reintentar ")])),e("button",{onClick:t[1]||(t[1]=s=>U(i).logout()),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},t[6]||(t[6]=[e("i",{class:"fas fa-sign-out-alt mr-2"},null,-1),_(" Cerrar sesión ")]))])])])):E("",!0),e("header",ye,[e("div",_e,[t[12]||(t[12]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Panel de Control",-1)),e("div",be,[I(te),e("div",we,[e("button",{onClick:t[2]||(t[2]=s=>m.value=!m.value),class:"flex items-center space-x-2 focus:outline-none"},[t[9]||(t[9]=e("span",{class:"inline-block h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center"},[e("i",{class:"fas fa-user text-indigo-600"})],-1)),e("span",ke,u(r.value),1)]),m.value?(a(),o("div",Ce,[e("div",Ee,[I(D,{to:"/perfil",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",onClick:t[3]||(t[3]=s=>m.value=!1)},{default:O(()=>t[10]||(t[10]=[e("i",{class:"fas fa-user-circle mr-2"},null,-1),_(" Perfil ")])),_:1,__:[10]}),e("button",{onClick:f,class:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem"},t[11]||(t[11]=[e("i",{class:"fas fa-sign-out-alt mr-2"},null,-1),_(" Cerrar sesión ")]))])])):E("",!0)])])])]),e("main",Se,[e("div",$e,[(a(!0),o(V,null,N(S.value,s=>(a(),W(ge,{key:s.title,title:s.title,value:s.value,icon:s.icon,trend:s.trend,"trend-value":s.trendValue,loading:y.value},null,8,["title","value","icon","trend","trend-value","loading"]))),128))]),e("div",De,[e("div",Ve,[e("div",Ne,[t[13]||(t[13]=e("h2",{class:"text-lg font-medium text-gray-900"},"Ventas Recientes",-1)),e("div",Le,[(a(),o(V,null,N(["Día","Semana","Mes"],s=>e("button",{key:s,onClick:A=>p.value=s.toLowerCase(),class:v(["px-3 py-1 text-sm rounded-md",{"bg-indigo-100 text-indigo-700":p.value===s.toLowerCase(),"text-gray-500 hover:bg-gray-100":p.value!==s.toLowerCase()}])},u(s),11,Pe)),64))])]),e("div",Me,[e("canvas",{ref_key:"salesChart",ref:w},null,512)])]),t[14]||(t[14]=G('<div class="bg-white rounded-lg shadow overflow-hidden" data-v-7d22d7e5><div class="p-6" data-v-7d22d7e5><h2 class="text-lg font-medium text-gray-900 mb-4" data-v-7d22d7e5>Vista 3D</h2><div class="h-64 flex items-center justify-center bg-gradient-to-br from-indigo-50 to-blue-50" data-v-7d22d7e5><div class="text-center" data-v-7d22d7e5><div class="text-6xl mb-2" data-v-7d22d7e5>⚡</div><p class="text-gray-600" data-v-7d22d7e5>Vista 3D</p><p class="text-sm text-gray-400" data-v-7d22d7e5>Próximamente</p></div></div></div></div>',1))]),e("div",Ae,[t[17]||(t[17]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Actividad Reciente"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500"}," Últimas actividades en el sistema ")],-1)),e("div",Be,[e("table",Ie,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actividad "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ")])],-1)),e("tbody",je,[(a(!0),o(V,null,N(k.value,(s,A)=>(a(),o("tr",{key:A},[e("td",ze,[e("div",qe,[e("div",Fe,[e("i",{class:v([$[s.type],"text-indigo-600 text-lg"])},null,2)]),e("div",Re,[e("div",He,u(s.title),1),e("div",Ue,u(s.description),1)])])]),e("td",Oe,[e("div",Ge,u(s.user),1)]),e("td",Je,[e("div",Te,u(d(s.timestamp)),1)]),e("td",We,[e("span",{class:v(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.status==="completed"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},u(s.status==="completed"?"Completado":s.status==="pending"?"Pendiente":"Error"),3)])]))),128)),k.value.length===0?(a(),o("tr",Ke,t[15]||(t[15]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"}," No hay actividades recientes ",-1)]))):E("",!0)])])])])])])}}},et=P(Qe,[["__scopeId","data-v-7d22d7e5"]]);export{et as default};
