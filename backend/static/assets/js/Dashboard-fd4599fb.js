import{p as T,r as x,c as S,x as L,q as F,y as R,o as i,b as c,e,t as f,n as _,z as U,k as C,g as D,C as V,A as H,B as A,D as O,f as P,w as G,F as B,E as N,G as J,h as W,H as K,I,J as q}from"./vendor-bdffe547.js";import{u as M,_ as $,a as Q}from"./index-0bb8e702.js";import{u as X}from"./WebSocketService-81868fc6.js";const Y=["title"],ee={class:"status-text"},te=T({__name:"SystemStatusBadge",setup(n){const o=M(),{status:d,error:m,connect:p,disconnect:h,cleanup:b}=X(),u=x(null),v=S(()=>{switch(d.value){case"connected":return"Connected";case"connecting":return"Connecting...";case"reconnecting":return"Reconnecting...";case"error":return"Connection Error";default:return"Disconnected"}}),E=S(()=>({"status-connected":d.value==="connected","status-connecting":d.value==="connecting","status-reconnecting":d.value==="reconnecting","status-error":d.value==="error","status-disconnected":d.value==="disconnected"})),r=S(()=>m.value?`Error: ${m.value.message}`:u.value?`Error: ${u.value.message}`:v.value);L(m,l=>{l&&(u.value=l)});const z=()=>{try{if(!o)return;o.isAuthenticated&&o.token&&p(o.token).catch(l=>{const g=l instanceof Error?l:new Error(String(l));u.value=g,g.message.includes("Network error")||g.message.includes("Tiempo de conexión agotado")})}catch(l){const g=l instanceof Error?l:new Error(String(l));u.value=g}};return L(()=>o.token,(l,g)=>{try{if(!l&&g){h();return}l&&o.isAuthenticated&&p(l).catch(y=>{const w=y instanceof Error?y:new Error(String(y));u.value=w})}catch(y){const w=y instanceof Error?y:new Error(String(y));u.value=w}},{immediate:!0}),F(()=>{z()}),R(()=>{b()}),(l,g)=>(i(),c("div",{class:_(["system-status-badge",E.value]),title:r.value},[g[0]||(g[0]=e("span",{class:"status-dot"},null,-1)),e("span",ee,f(v.value),1)],10,Y))}});const se=$(te,[["__scopeId","data-v-09c05868"]]),ne="/images/zues-3d-main.png";const oe={class:"zeus-3d-container relative flex flex-col items-center justify-center h-full w-full"},ae={__name:"Zeus3D",setup(n){const o=U(),d=M(),m=x(!0),p=()=>{o.push("/perfil")},h=()=>{o.push("/dashboard")},b=()=>{alert("Estado del sistema: conectado")},u=()=>{m.value=!m.value},v=async()=>{await d.logout(),o.push("/login")};return(E,r)=>(i(),c("div",oe,[r[5]||(r[5]=e("img",{src:ne,alt:"ZEUS IA Zeus",class:"zeus-3d-image rounded-xl shadow-lg object-cover",draggable:"false"},null,-1)),e("div",{class:"zeus-3d-buttons absolute inset-0 flex flex-col items-end justify-between p-6 pointer-events-none"},[e("div",{class:"flex flex-col space-y-4 mt-2 pointer-events-auto"},[e("button",{onClick:p,class:"zeus-btn",title:"Perfil de usuario"},r[0]||(r[0]=[e("i",{class:"fas fa-user-circle"},null,-1)])),e("button",{onClick:h,class:"zeus-btn",title:"Panel de control"},r[1]||(r[1]=[e("i",{class:"fas fa-tachometer-alt"},null,-1)])),e("button",{onClick:b,class:"zeus-btn",title:"Estado del sistema"},r[2]||(r[2]=[e("i",{class:"fas fa-signal"},null,-1)])),e("button",{onClick:u,class:"zeus-btn",title:"Vista 3D"},r[3]||(r[3]=[e("i",{class:"fas fa-cube"},null,-1)]))]),e("div",{class:"flex flex-col pointer-events-auto"},[e("button",{onClick:v,class:"zeus-btn",title:"Cerrar sesión"},r[4]||(r[4]=[e("i",{class:"fas fa-sign-out-alt"},null,-1)]))])])]))}},re=$(ae,[["__scopeId","data-v-d3f707c0"]]);const le={class:"bg-white overflow-hidden shadow rounded-lg"},ie={class:"p-5"},de={class:"flex items-center"},ce={key:1,class:"h-6 w-6"},ue={class:"ml-5 w-0 flex-1"},ge={class:"text-sm font-medium text-gray-500 truncate"},fe={class:"text-lg font-medium text-gray-900"},me={key:0,class:"mt-4 flex items-center"},xe={key:1,class:"mt-4"},pe={__name:"DashboardMetric",props:{title:{type:String,required:!0},value:{type:[String,Number],required:!0},icon:{type:String,required:!0},trend:{type:String,validator:n=>["up","down",null,void 0].includes(n),default:null},trendValue:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(n){return(o,d)=>(i(),c("div",le,[e("div",ie,[e("div",de,[e("div",{class:_(["flex-shrink-0 rounded-md p-3",{"bg-indigo-100":!n.loading,"bg-gray-200":n.loading,"animate-pulse":n.loading}])},[n.loading?(i(),c("div",ce)):(i(),c("i",{key:0,class:_(["fas",`fa-${n.icon}`,"text-indigo-600 text-lg"])},null,2))],2),e("div",ue,[e("dl",null,[e("dt",ge,f(n.loading?"Cargando...":n.title),1),e("dd",null,[e("div",fe,f(n.loading?"...":n.value),1)])])])]),!n.loading&&n.trend?(i(),c("div",me,[e("span",{class:_(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n.trend==="up"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("i",{class:_(["mr-1",n.trend==="up"?"fa-arrow-up":"fa-arrow-down"])},null,2),C(" "+f(n.trendValue),1)],2),d[0]||(d[0]=e("span",{class:"ml-2 text-sm text-gray-500"}," vs. período anterior ",-1))])):n.loading?(i(),c("div",xe,d[1]||(d[1]=[e("div",{class:"h-4 bg-gray-200 rounded w-3/4"},null,-1)]))):D("",!0)])]))}},ve=$(pe,[["__scopeId","data-v-b4acc032"]]);const ye={class:"dashboard"},he={key:0,class:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50"},be={key:1,class:"fixed inset-0 bg-white flex items-center justify-center z-50"},_e={class:"text-center p-6 max-w-md mx-auto"},we={class:"mt-2 text-sm text-gray-500"},ke={class:"mt-5"},Ce={class:"bg-white shadow"},Ee={class:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8 flex justify-between items-center"},Se={class:"flex items-center space-x-4"},De={class:"relative"},$e={class:"hidden md:inline text-sm font-medium text-gray-700"},ze={key:0,class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50",role:"menu",tabindex:"-1"},Ve={class:"py-1",role:"none"},Ae={class:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8"},Pe={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8"},Be={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},Ne={class:"lg:col-span-2 bg-white rounded-lg shadow p-6"},Le={class:"flex justify-between items-center mb-4"},Me={class:"flex space-x-2"},je=["onClick"],Ie={class:"h-64"},qe={class:"bg-white rounded-lg shadow overflow-hidden"},Fe={class:"p-6"},Re={class:"h-64"},Ue={class:"bg-white shadow overflow-hidden sm:rounded-lg"},Ze={class:"overflow-x-auto"},Te={class:"min-w-full divide-y divide-gray-200"},He={class:"bg-white divide-y divide-gray-200"},Oe={class:"px-6 py-4 whitespace-nowrap"},Ge={class:"flex items-center"},Je={class:"flex-shrink-0 h-10 w-10"},We={class:"ml-4"},Ke={class:"text-sm font-medium text-gray-900"},Qe={class:"text-sm text-gray-500"},Xe={class:"px-6 py-4 whitespace-nowrap"},Ye={class:"text-sm text-gray-900"},et={class:"px-6 py-4 whitespace-nowrap"},tt={class:"text-sm text-gray-500"},st={class:"px-6 py-4 whitespace-nowrap"},nt={key:0},ot={__name:"Dashboard",setup(n){V.register(...H);const o=M(),d=U(),m=x("día"),p=x(!1),h=x(!0),b=x(null),u=x(null);x(null);const v=x(null),E=x([{title:"Ventas Hoy",value:"1,245",icon:"shopping-cart",trend:"up",trendValue:"12%",loading:!1},{title:"Ingresos",value:"$12,548",icon:"dollar-sign",trend:"down",trendValue:"3%"},{title:"Clientes Nuevos",value:"24",icon:"users",trend:"up",trendValue:"8%"},{title:"Órdenes",value:"156",icon:"box",trend:"up",trendValue:"5%"}]),r=x([{id:1,title:"Nueva orden creada",description:"Orden #1001 por $125.75",type:"order",user:"Juan Pérez",timestamp:new Date,status:"completed"},{id:2,title:"Error de pago",description:"Error al procesar el pago #1002",type:"error",user:"María García",timestamp:A(new Date,1),status:"error"},{id:3,title:"Nuevo cliente registrado",description:"Carlos López se ha registrado",type:"user",user:"Sistema",timestamp:A(new Date,2),status:"completed"}]),z={order:"fas fa-shopping-cart",error:"fas fa-exclamation-circle",user:"fas fa-user-plus",system:"fas fa-cog"},l=S(()=>o.userFullName||"Usuario"),g=a=>{if(!a)return"";try{const t=typeof a=="string"?new Date(a):a;return I(t,"dd/MM/yyyy HH:mm",{locale:q})}catch{return"Fecha inválida"}},y=async()=>{try{await o.logout(),d.push("/login")}catch{}},w=a=>{const t=document.querySelector(".user-menu"),k=document.querySelector('[aria-expanded="true"]');t&&k&&!t.contains(a.target)&&!k.contains(a.target)&&(p.value=!1)},Z=()=>{if(v.value){const a=V.getChart(v.value);a&&a.destroy()}if(v.value){const a=v.value.getContext("2d");new V(a,{type:"line",data:{labels:Array.from({length:7},(t,k)=>{const s=A(new Date,6-k);return I(s,"EEE",{locale:q})}),datasets:[{label:"Ventas",data:[12,19,3,5,2,3,15],borderColor:"rgb(79, 70, 229)",backgroundColor:"rgba(79, 70, 229, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{display:!0,drawBorder:!1},ticks:{stepSize:5}},x:{grid:{display:!1,drawBorder:!1}}}}})}};return L(m,a=>{}),F(()=>{(async()=>{try{if(h.value=!0,b.value=null,!o.isAuthenticated&&!await o.refreshAccessToken())throw new Error("Sesión expirada. Por favor, inicia sesión nuevamente.");try{u.value=await Q.getCurrentUser()}catch(t){if(o.user)u.value=o.user;else throw t}await Promise.all([]),J(()=>{Z()})}catch(t){b.value=t.response?.data?.message||t.message||"Error al cargar los datos del dashboard",(t.response?.status===401||t.message.includes("Sesión expirada"))&&(o.logout(),d.push("/login"))}finally{h.value=!1}})(),document.addEventListener("click",w)}),R(()=>{document.removeEventListener("click",w)}),(a,t)=>{const k=W("router-link");return i(),c("div",ye,[h.value?(i(),c("div",he,t[4]||(t[4]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e("p",{class:"mt-4 text-gray-700"},"Cargando datos del dashboard...")],-1)]))):b.value?(i(),c("div",be,[e("div",_e,[t[7]||(t[7]=e("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[e("i",{class:"fas fa-exclamation-triangle text-red-600 text-xl"})],-1)),t[8]||(t[8]=e("h3",{class:"mt-3 text-lg font-medium text-gray-900"},"Error al cargar el dashboard",-1)),e("p",we,f(b.value),1),e("div",ke,[e("button",{onClick:t[0]||(t[0]=(...s)=>a.retryLoading&&a.retryLoading(...s)),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},t[5]||(t[5]=[e("i",{class:"fas fa-sync-alt mr-2"},null,-1),C(" Reintentar ")])),e("button",{onClick:t[1]||(t[1]=s=>O(o).logout()),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},t[6]||(t[6]=[e("i",{class:"fas fa-sign-out-alt mr-2"},null,-1),C(" Cerrar sesión ")]))])])])):D("",!0),e("header",Ce,[e("div",Ee,[t[12]||(t[12]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Panel de Control",-1)),e("div",Se,[P(se),e("div",De,[e("button",{onClick:t[2]||(t[2]=s=>p.value=!p.value),class:"flex items-center space-x-2 focus:outline-none"},[t[9]||(t[9]=e("span",{class:"inline-block h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center"},[e("i",{class:"fas fa-user text-indigo-600"})],-1)),e("span",$e,f(l.value),1)]),p.value?(i(),c("div",ze,[e("div",Ve,[P(k,{to:"/perfil",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",onClick:t[3]||(t[3]=s=>p.value=!1)},{default:G(()=>t[10]||(t[10]=[e("i",{class:"fas fa-user-circle mr-2"},null,-1),C(" Perfil ")])),_:1,__:[10]}),e("button",{onClick:y,class:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem"},t[11]||(t[11]=[e("i",{class:"fas fa-sign-out-alt mr-2"},null,-1),C(" Cerrar sesión ")]))])])):D("",!0)])])])]),e("main",Ae,[e("div",Pe,[(i(!0),c(B,null,N(E.value,s=>(i(),K(ve,{key:s.title,title:s.title,value:s.value,icon:s.icon,trend:s.trend,"trend-value":s.trendValue,loading:h.value},null,8,["title","value","icon","trend","trend-value","loading"]))),128))]),e("div",Be,[e("div",Ne,[e("div",Le,[t[13]||(t[13]=e("h2",{class:"text-lg font-medium text-gray-900"},"Ventas Recientes",-1)),e("div",Me,[(i(),c(B,null,N(["Día","Semana","Mes"],s=>e("button",{key:s,onClick:j=>m.value=s.toLowerCase(),class:_(["px-3 py-1 text-sm rounded-md",{"bg-indigo-100 text-indigo-700":m.value===s.toLowerCase(),"text-gray-500 hover:bg-gray-100":m.value!==s.toLowerCase()}])},f(s),11,je)),64))])]),e("div",Ie,[e("canvas",{ref_key:"salesChart",ref:v},null,512)])]),e("div",qe,[e("div",Fe,[t[14]||(t[14]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Vista 3D",-1)),e("div",Re,[P(re,{class:"h-full w-full"})])])])]),e("div",Ue,[t[17]||(t[17]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Actividad Reciente"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500"}," Últimas actividades en el sistema ")],-1)),e("div",Ze,[e("table",Te,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actividad "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ")])],-1)),e("tbody",He,[(i(!0),c(B,null,N(r.value,(s,j)=>(i(),c("tr",{key:j},[e("td",Oe,[e("div",Ge,[e("div",Je,[e("i",{class:_([z[s.type],"text-indigo-600 text-lg"])},null,2)]),e("div",We,[e("div",Ke,f(s.title),1),e("div",Qe,f(s.description),1)])])]),e("td",Xe,[e("div",Ye,f(s.user),1)]),e("td",et,[e("div",tt,f(g(s.timestamp)),1)]),e("td",st,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.status==="completed"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},f(s.status==="completed"?"Completado":s.status==="pending"?"Pendiente":"Error"),3)])]))),128)),r.value.length===0?(i(),c("tr",nt,t[15]||(t[15]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"}," No hay actividades recientes ",-1)]))):D("",!0)])])])])])])}}},it=$(ot,[["__scopeId","data-v-029e61fb"]]);export{it as default};
