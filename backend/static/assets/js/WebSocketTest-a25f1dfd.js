import{u as $,_ as D}from"./index-6bfee18c.js";import{u as E}from"./WebSocketService-cc599e46.js";import{p as F,r as g,x as b,c as S,q as h,y as O,b as l,e as t,n as y,t as i,D as u,F as B,E as I,g as C,o as d}from"./vendor-3902db62.js";const J={class:"websocket-test"},L={class:"connection-status"},U=["disabled"],z=["disabled"],A={class:"message-log"},P={class:"log-entries"},V={class:"timestamp"},q={class:"message"},j={key:0,class:"error"},G={key:0,class:"token-info"},H={class:"token-preview"},K=F({__name:"WebSocketTest",setup(Q){const n=$(),_=g([]),{status:f,isConnected:a,connect:m,disconnect:v,error:T}=E(),r=g(null);b(f,e=>{e==="connected"&&!r.value?r.value=new WebSocket(`wss://zeus-ia-production-16d8.up.railway.app/ws/ws?token=${n.token}`):(e==="disconnected"||e==="error")&&(r.value=null),e==="connected"?o("WebSocket connected successfully","info"):e==="disconnected"?o("WebSocket disconnected","info"):e==="error"&&o("WebSocket connection error","error")});const k=g(!1),W=S(()=>({"status-connected":a.value,"status-connecting":k.value,"status-disconnected":!a.value&&!k.value})),w=S(()=>{if(!n.token)return"No token available";const e=n.token;return`${e.substring(0,15)}...${e.substring(e.length-15)}`}),o=(e,s="info",c)=>{const p={type:s,message:e,timestamp:new Date().toISOString().split("T")[1].split(".")[0],error:c instanceof Error?c.message:String(c)};_.value.unshift(p)},x=()=>{a.value?v():m(n.token)},M=()=>{if(!a.value||!r.value){o("Not connected to WebSocket server","error");return}const e={type:"test",data:"This is a test message",timestamp:new Date().toISOString()};try{r.value.send(JSON.stringify(e)),o(`Sent: ${JSON.stringify(e)}`,"sent")}catch(s){o("Failed to send message","error",s)}},N=async()=>{if(n.token)try{await navigator.clipboard.writeText(n.token),o("Token copied to clipboard","info")}catch(e){o("Failed to copy token","error",e)}};return b(T,e=>{e&&o(`Error: ${e.message}`,"error")}),h(()=>{m(n.token)}),O(()=>{v()}),h(()=>{n.isAuthenticated?o("User is authenticated, ready to connect","info"):o("User is not authenticated. Please log in to test WebSocket connection.","error")}),(e,s)=>(d(),l("div",J,[s[3]||(s[3]=t("h1",null,"WebSocket Connection Test",-1)),t("div",L,[s[0]||(s[0]=t("h3",null,"Connection Status:",-1)),t("div",{class:y(["status-indicator",W.value])},i(u(f)),3),t("button",{onClick:x,disabled:k.value,class:"connect-btn"},i(u(a)?"Disconnect":"Connect"),9,U),t("button",{onClick:M,disabled:!u(a),class:"test-btn"}," Send Test Message ",8,z)]),t("div",A,[s[1]||(s[1]=t("h3",null,"Message Log:",-1)),t("div",P,[(d(!0),l(B,null,I(_.value,(c,p)=>(d(),l("div",{key:p,class:y(["log-entry",c.type])},[t("span",V,"["+i(c.timestamp)+"]",1),t("span",q,i(c.message),1),c.error?(d(),l("span",j,"Error: "+i(c.error),1)):C("",!0)],2))),128))])]),u(n).token?(d(),l("div",G,[s[2]||(s[2]=t("h3",null,"JWT Token:",-1)),t("div",H,i(w.value),1),t("button",{onClick:N,class:"copy-btn"}," Copy Token ")])):C("",!0)]))}});const Z=D(K,[["__scopeId","data-v-b8d2871e"]]);export{Z as default};
