import{u as x,a as D,_ as E}from"./index-8d114c92.js";import{m as F,r as g,p as b,c as S,q as h,s as O,b as l,e as t,n as y,t as i,z as u,F as z,A,g as C,o as d}from"./vendor-04204560.js";import"./three-c4693b27.js";const B={class:"websocket-test"},I={class:"connection-status"},J=["disabled"],L=["disabled"],U={class:"message-log"},P={class:"log-entries"},V={class:"timestamp"},q={class:"message"},j={key:0,class:"error"},G={key:0,class:"token-info"},H={class:"token-preview"},K=F({__name:"WebSocketTest",setup(Q){const n=x(),_=g([]),{status:m,isConnected:c,connect:v,disconnect:f,error:T}=D(),r=g(null);b(m,e=>{e==="connected"&&!r.value?r.value=new WebSocket(`wss://zeus-ia-production-16d8.up.railway.app/ws/ws?token=${n.token}`):(e==="disconnected"||e==="error")&&(r.value=null),e==="connected"?o("WebSocket connected successfully","info"):e==="disconnected"?o("WebSocket disconnected","info"):e==="error"&&o("WebSocket connection error","error")});const k=g(!1),W=S(()=>({"status-connected":c.value,"status-connecting":k.value,"status-disconnected":!c.value&&!k.value})),w=S(()=>{if(!n.token)return"No token available";const e=n.token;return`${e.substring(0,15)}...${e.substring(e.length-15)}`}),o=(e,s="info",a)=>{const p={type:s,message:e,timestamp:new Date().toISOString().split("T")[1].split(".")[0],error:a instanceof Error?a.message:String(a)};_.value.unshift(p)},M=()=>{c.value?f():v(n.token)},N=()=>{if(!c.value||!r.value){o("Not connected to WebSocket server","error");return}const e={type:"test",data:"This is a test message",timestamp:new Date().toISOString()};try{r.value.send(JSON.stringify(e)),o(`Sent: ${JSON.stringify(e)}`,"sent")}catch(s){o("Failed to send message","error",s)}},$=async()=>{if(n.token)try{await navigator.clipboard.writeText(n.token),o("Token copied to clipboard","info")}catch(e){o("Failed to copy token","error",e)}};return b(T,e=>{e&&o(`Error: ${e.message}`,"error")}),h(()=>{v(n.token)}),O(()=>{f()}),h(()=>{n.isAuthenticated?o("User is authenticated, ready to connect","info"):o("User is not authenticated. Please log in to test WebSocket connection.","error")}),(e,s)=>(d(),l("div",B,[s[3]||(s[3]=t("h1",null,"WebSocket Connection Test",-1)),t("div",I,[s[0]||(s[0]=t("h3",null,"Connection Status:",-1)),t("div",{class:y(["status-indicator",W.value])},i(u(m)),3),t("button",{onClick:M,disabled:k.value,class:"connect-btn"},i(u(c)?"Disconnect":"Connect"),9,J),t("button",{onClick:N,disabled:!u(c),class:"test-btn"}," Send Test Message ",8,L)]),t("div",U,[s[1]||(s[1]=t("h3",null,"Message Log:",-1)),t("div",P,[(d(!0),l(z,null,A(_.value,(a,p)=>(d(),l("div",{key:p,class:y(["log-entry",a.type])},[t("span",V,"["+i(a.timestamp)+"]",1),t("span",q,i(a.message),1),a.error?(d(),l("span",j,"Error: "+i(a.error),1)):C("",!0)],2))),128))])]),u(n).token?(d(),l("div",G,[s[2]||(s[2]=t("h3",null,"JWT Token:",-1)),t("div",H,i(w.value),1),t("button",{onClick:$,class:"copy-btn"}," Copy Token ")])):C("",!0)]))}});const Z=E(K,[["__scopeId","data-v-b8d2871e"]]);export{Z as default};
